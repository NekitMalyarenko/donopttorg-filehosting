{"version":3,"sources":["webpack:///./src/views/AdminNewsEditor.vue?4cac","webpack:///src/views/AdminNewsEditor.vue","webpack:///./src/views/AdminNewsEditor.vue?c6e9","webpack:///./src/views/AdminNewsEditor.vue","webpack:///./src/views/AdminNewsEditor.vue?2826"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticRenderFns","BODY_PLACEHOLDER","AdminNewsEditorvue_type_script_lang_js_","name","data","title","textData","type","aside","isVisible","y","lastTarget","tools","x","methods","init","root","document","querySelector","length","forEach","item","res","createElement","innerText","appendChild","window","onclick","onClick","onKeyDown","event","key","onBackspace","isTextDataEmpty","target","removeAttribute","preventDefault","innerHTML","newElement","setAttribute","onKeyUp","getSelection","getRangeAt","startContainer","reCalculateAsidePos","updateTextData","rootElement","children","querySelectorAll","i","child","push","tagName","onMouseUp","parentNode","getBoundingClientRect","getElementsByClassName","titleInput","classList","add","remove","showImageSelection","getElementById","click","onImagesSelect","_this","console","log","files","reader","FileReader","onload","e","elem","img","result","insertBefore","readAsDataURL","computed","mounted","views_AdminNewsEditorvue_type_script_lang_js_","component","Object","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_css_loader_index_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_9_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_AdminNewsEditor_vue_vue_type_style_index_0_lang_sass___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_css_loader_index_js_ref_9_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_9_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_AdminNewsEditor_vue_vue_type_style_index_0_lang_sass___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/adminNews.23e59d4d.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"layout\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <section class=\"layout\">\r\n        <!--<h1 data-placeholder=\"Заголовок...\" @input=\"titleInput\"\r\n            class=\"empty\" contentEditable=\"true\"\r\n            spellcheck=\"false\">\r\n\r\n        </h1>\r\n\r\n        <article contentEditable=\"true\" spellcheck=\"false\" dir=\"auto\"\r\n                 @keyup=\"onKeyUp\" @keydown=\"onKeyDown\"\r\n                 @mouseup=\"onMouseUp\">\r\n\r\n        </article>\r\n\r\n        <aside v-if=\"aside.isVisible\" v-bind:style=\"{'top': aside.y + 'px'}\">\r\n            <i class=\"fas fa-camera\" @click=\"showImageSelection\"></i>\r\n\r\n            <input id=\"fileInput\" type=\"file\" style=\"display: none;\"\r\n                   accept=\".jpg, .jpeg, .png\" multiple @change=\"onImagesSelect\"/>\r\n        </aside>\r\n\r\n        <section class=\"tools\" v-if=\"tools.isVisible\" v-bind:style=\"{'top': tools.y + 'px', 'left': tools.x + 'px'}\">\r\n\r\n        </section>-->\r\n\r\n    </section>\r\n</template>\r\n\r\n<script>\r\n    const BODY_PLACEHOLDER = \"Ну ты это... Заходи, есл..\";\r\n\r\n    export default {\r\n        name: \"AdminNewsEditor\",\r\n\r\n        data: () => {\r\n            return {\r\n                title: \"\",\r\n\r\n                textData: [\r\n                    {\r\n                        type: \"text\",\r\n                        data: \"test\"\r\n                    }\r\n                ],\r\n\r\n                aside: {\r\n                    isVisible: false,\r\n                    y: -1,\r\n                    lastTarget: null,\r\n                },\r\n\r\n                tools: {\r\n                    isVisible: false,\r\n                    x: -1,\r\n                    y: -1,\r\n                },\r\n            }\r\n        },\r\n\r\n        methods: {\r\n            init() {\r\n                let root = document.querySelector(\"article\");\r\n\r\n                if (this.textData.length !== 0) {\r\n                    this.textData.forEach((item) => {\r\n                        let res;\r\n\r\n                        if (item.type === \"text\") {\r\n                            res = document.createElement(\"p\");\r\n                            res.innerText = item.data;\r\n                        }\r\n\r\n                        root.appendChild(res);\r\n                    })\r\n                }\r\n\r\n                window.onclick = this.onClick\r\n            },\r\n\r\n            onKeyDown(event) {\r\n                //console.log(\"onKeyDown\", {event});\r\n\r\n                switch (event.key) {\r\n\r\n                    case \"Backspace\":\r\n                        this.onBackspace(event);\r\n                        break;\r\n\r\n                    default:\r\n                        if (this.isTextDataEmpty) {\r\n                            event.target.querySelector(\"p\").removeAttribute(\"class\");\r\n                            event.target.querySelector(\"p\").removeAttribute(\"data-placeholder\");\r\n                        }\r\n                        break;\r\n\r\n                }\r\n            },\r\n\r\n            onBackspace(event) {\r\n                //console.log(\"onBackspace\", {text: event.target.innerText.length});\r\n\r\n                if (event.target.innerText.length === 1) {\r\n                    event.preventDefault();\r\n                    event.target.innerHTML = \"\";\r\n\r\n                    let newElement = document.createElement(\"p\");\r\n                    newElement.innerText = \"\";\r\n                    newElement.innerHTML = \"<br>\";\r\n                    newElement.setAttribute(\"class\", \"empty\");\r\n                    newElement.setAttribute(\"data-placeholder\", BODY_PLACEHOLDER);\r\n\r\n                    event.target.appendChild(newElement);\r\n                }\r\n            },\r\n\r\n            onKeyUp(event) {\r\n                switch (event.key) {\r\n                    default:\r\n                        if (window.getSelection().getRangeAt(0).startContainer.innerText === \"\\n\") {\r\n                            this.reCalculateAsidePos();\r\n                            this.aside.isVisible = true;\r\n                        } else {\r\n                            this.aside.isVisible = false;\r\n                        }\r\n                        break\r\n                }\r\n\r\n                this.updateTextData(event.target);\r\n            },\r\n\r\n            updateTextData(rootElement) {\r\n                this.textData = [];\r\n                let children = rootElement.querySelectorAll(\"p\");\r\n\r\n                for (let i = 0; i < children.length; i++) {\r\n                    let child = children[i];\r\n                    this.textData.push({\r\n                        type: \"text\",\r\n                        data: child.innerText.length === 0 ? \"\\n\" : child.innerText,\r\n                    });\r\n                }\r\n            },\r\n\r\n            onClick(event) {\r\n                if ((event.target.tagName === \"P\" || event.target.tagName === \"ARTICLE\") && event.target.innerText === \"\\n\") {\r\n                    this.reCalculateAsidePos();\r\n                    this.aside.isVisible = true;\r\n                } else if(event.target.tagName !== \"I\") {\r\n                    this.aside.isVisible = false;\r\n                    this.tools.isVisible = false;\r\n                }\r\n            },\r\n\r\n            onMouseUp(event) {\r\n                /*console.log(\"OnMouseUp\", {event, sel: window.getSelection()});\r\n                this.tools.x = event.layerX;\r\n                this.tools.y = event.layerY - (24 + event.target.clientHeight);\r\n                this.tools.isVisible = true;*/\r\n            },\r\n\r\n            reCalculateAsidePos() {\r\n                if (window.getSelection() && window.getSelection().getRangeAt(0)) {\r\n                    let target;\r\n\r\n                    if (document.querySelectorAll(\"article > p\").length > 1) {\r\n                        target = window.getSelection().getRangeAt(0).startContainer;\r\n                        if (target.tagName !== \"P\") {\r\n                            target = target.parentNode;\r\n                        }\r\n                    } else {\r\n                        target = document.querySelectorAll(\"article > p\")[0]\r\n                    }\r\n\r\n                    this.aside.lastTarget = target;\r\n                    this.aside.y = target.getBoundingClientRect().y -\r\n                        document.getElementsByClassName(\"layout\")[0].getBoundingClientRect().y\r\n                }\r\n            },\r\n\r\n            titleInput(event) {\r\n                this.title = event.target.innerText;\r\n                if (this.title.length === 0) {\r\n                    event.target.classList.add(\"empty\");\r\n                } else {\r\n                    event.target.classList.remove(\"empty\");\r\n                }\r\n            },\r\n\r\n            showImageSelection() {\r\n                document.getElementById(\"fileInput\").click();\r\n            },\r\n\r\n            onImagesSelect(event) {\r\n                console.log({event, files: event.target.files});\r\n\r\n                if (event.target.files && event.target.files[0]) {\r\n                    let reader = new FileReader();\r\n\r\n                    reader.onload = (e) => {\r\n                        let elem = document.createElement(\"section\");\r\n                        elem.setAttribute(\"class\", \"image-figure\");\r\n                        elem.setAttribute(\"contentEditable\", \"false\");\r\n\r\n                        let img = document.createElement(\"img\");\r\n                        img.setAttribute('src', e.target.result);\r\n\r\n                        console.log({target: this.aside.lastTarget});\r\n\r\n                        elem.appendChild(img);\r\n                        document.querySelector(\"article\").insertBefore(elem, this.aside.lastTarget);\r\n                    };\r\n\r\n                    reader.readAsDataURL(event.target.files[0]);\r\n                }\r\n            },\r\n        },\r\n\r\n        computed: {\r\n            isTextDataEmpty: function () {\r\n                return this.textData.length === 1 && this.textData[0].data === \"\\n\"\r\n            }\r\n        },\r\n\r\n        mounted() {\r\n            //this.init();\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"sass\">\r\n\r\n    .layout\r\n        width: 90%\r\n        margin: auto\r\n        position: relative\r\n        max-width: 500px\r\n        font-family: Roboto, sans-serif\r\n\r\n        h1\r\n            outline: none\r\n            font-size: 32px\r\n            margin-left: 25px\r\n\r\n        .empty\r\n            position: relative\r\n\r\n            &:before\r\n                position: absolute\r\n                left: 0\r\n                top: 0\r\n                content: attr(data-placeholder)\r\n                color: rgba(0,0,0,.44)\r\n                font-weight: 400\r\n                white-space: nowrap\r\n                text-overflow: ellipsis\r\n                overflow: hidden\r\n                pointer-events: none\r\n\r\n        article\r\n            outline: none\r\n            font-size: 18px\r\n            margin-left: 25px\r\n\r\n            p\r\n                margin-top: 1rem\r\n                margin-bottom: 1rem\r\n                font-size: 18px\r\n\r\n            .image-figure\r\n                img\r\n                    width: 100%\r\n\r\n        aside\r\n            position: absolute\r\n            transition: 0.25s\r\n            top: 0\r\n            left: 0\r\n\r\n            i\r\n                cursor: pointer\r\n                font-size: 18px\r\n\r\n        .tools\r\n            position: absolute\r\n            width: 50px\r\n            height: 24px\r\n            background-color: #1D5DB5\r\n            border-radius: 5px\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminNewsEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminNewsEditor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AdminNewsEditor.vue?vue&type=template&id=096ae459&\"\nimport script from \"./AdminNewsEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./AdminNewsEditor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AdminNewsEditor.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/index.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminNewsEditor.vue?vue&type=style&index=0&lang=sass&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/index.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminNewsEditor.vue?vue&type=style&index=0&lang=sass&\""],"sourceRoot":""}