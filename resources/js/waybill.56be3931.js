(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["waybill","catalog"],{"441b":function(t,i,e){},5176:function(t,i,e){t.exports=e("51b6")},"51b6":function(t,i,e){e("a3c3"),t.exports=e("584a").Object.assign},"544e":function(t,i,e){"use strict";var a=e("441b"),n=e.n(a);n.a},"5d6b":function(t,i,e){var a=e("e53d").parseInt,n=e("a1ce").trim,s=e("e692"),l=/^[-+]?0[xX]/;t.exports=8!==a(s+"08")||22!==a(s+"0x16")?function(t,i){var e=n(String(t),3);return a(e,i>>>0||(l.test(e)?16:10))}:a},"5dbc":function(t,i,e){var a=e("d3f4"),n=e("8b97").set;t.exports=function(t,i,e){var s,l=i.constructor;return l!==e&&"function"==typeof l&&(s=l.prototype)!==e.prototype&&a(s)&&n&&n(t,s),t}},7445:function(t,i,e){var a=e("63b6"),n=e("5d6b");a(a.G+a.F*(parseInt!=n),{parseInt:n})},7459:function(t,i,e){"use strict";var a=e("eb59"),n=e.n(a);n.a},"74e1":function(t,i,e){},"7afe":function(t,i,e){"use strict";var a=e("74e1"),n=e.n(a);n.a},"7b58":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("section",{staticClass:"md-input-container",class:{"not-valid":!t.isValid}},[e("section",{staticClass:"md-input",class:{"not-empty":!t.isEmpty}},[t.isTextArea?e("textarea",{attrs:{rows:"2",disabled:!t.isEditable},on:{input:t.onInput}}):e("input",{attrs:{type:"text",disabled:!t.isEditable},on:{input:t.onInput}}),e("span",{staticClass:"bar"}),e("label",[t._v(t._s(t.label))])])])},n=[],s={name:"MDInput",data:function(){return{isEmpty:!0,isValid:!0,isEditable:!0,data:""}},props:{label:{type:String,required:!0},isTextArea:{type:Boolean,default:!1}},methods:{onInput:function(t){var i=t.target.value.length;this.isEmpty=0===i,this.data=t.target.value,this.$emit("input")}}},l=s,r=(e("544e"),e("2877")),c=Object(r["a"])(l,a,n,!1,null,"c08348b2",null);i["a"]=c.exports},"8b97":function(t,i,e){var a=e("d3f4"),n=e("cb7c"),s=function(t,i){if(n(t),!a(i)&&null!==i)throw TypeError(i+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,i,a){try{a=e("9b43")(Function.call,e("11e9").f(Object.prototype,"__proto__").set,2),a(t,[]),i=!(t instanceof Array)}catch(n){i=!0}return function(t,e){return s(t,e),i?t.__proto__=e:a(t,e),t}}({},!1):void 0),check:s}},9306:function(t,i,e){"use strict";var a=e("c3a1"),n=e("9aa9"),s=e("355d"),l=e("241e"),r=e("335c"),c=Object.assign;t.exports=!c||e("294c")(function(){var t={},i={},e=Symbol(),a="abcdefghijklmnopqrst";return t[e]=7,a.split("").forEach(function(t){i[t]=t}),7!=c({},t)[e]||Object.keys(c({},i)).join("")!=a})?function(t,i){var e=l(t),c=arguments.length,o=1,u=n.f,d=s.f;while(c>o){var p,b=r(arguments[o++]),f=u?a(b).concat(u(b)):a(b),h=f.length,g=0;while(h>g)d.call(b,p=f[g++])&&(e[p]=b[p])}return e}:c},a1ce:function(t,i,e){var a=e("63b6"),n=e("25eb"),s=e("294c"),l=e("e692"),r="["+l+"]",c="​",o=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),d=function(t,i,e){var n={},r=s(function(){return!!l[t]()||c[t]()!=c}),o=n[t]=r?i(p):l[t];e&&(n[e]=o),a(a.P+a.F*r,"String",n)},p=d.trim=function(t,i){return t=String(n(t)),1&i&&(t=t.replace(o,"")),2&i&&(t=t.replace(u,"")),t};t.exports=d},a3c3:function(t,i,e){var a=e("63b6");a(a.S+a.F,"Object",{assign:e("9306")})},aa77:function(t,i,e){var a=e("5ca1"),n=e("be13"),s=e("79e5"),l=e("fdef"),r="["+l+"]",c="​",o=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),d=function(t,i,e){var n={},r=s(function(){return!!l[t]()||c[t]()!=c}),o=n[t]=r?i(p):l[t];e&&(n[e]=o),a(a.P+a.F*r,"String",n)},p=d.trim=function(t,i){return t=String(n(t)),1&i&&(t=t.replace(o,"")),2&i&&(t=t.replace(u,"")),t};t.exports=d},b9e9:function(t,i,e){e("7445"),t.exports=e("584a").parseInt},c5f6:function(t,i,e){"use strict";var a=e("7726"),n=e("69a8"),s=e("2d95"),l=e("5dbc"),r=e("6a99"),c=e("79e5"),o=e("9093").f,u=e("11e9").f,d=e("86cc").f,p=e("aa77").trim,b="Number",f=a[b],h=f,g=f.prototype,m=s(e("2aeb")(g))==b,y="trim"in String.prototype,v=function(t){var i=r(t,!1);if("string"==typeof i&&i.length>2){i=y?i.trim():p(i,3);var e,a,n,s=i.charCodeAt(0);if(43===s||45===s){if(e=i.charCodeAt(2),88===e||120===e)return NaN}else if(48===s){switch(i.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+i}for(var l,c=i.slice(2),o=0,u=c.length;o<u;o++)if(l=c.charCodeAt(o),l<48||l>n)return NaN;return parseInt(c,a)}}return+i};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var i=arguments.length<1?0:t,e=this;return e instanceof f&&(m?c(function(){g.valueOf.call(e)}):s(e)!=b)?l(new h(v(i)),e,f):v(i)};for(var _,w=e("9e1e")?o(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;w.length>E;E++)n(h,_=w[E])&&!n(f,_)&&d(f,_,u(h,_));f.prototype=g,g.constructor=f,e("2aba")(a,b,f)}},cb72:function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("section",[t.hasWaybill?e("section",{staticClass:"layout-waybill"},[e("div",{staticClass:"header"},[e("p",{staticClass:"title"},[t._v("\n                #"+t._s(t.waybill.numberInvoice)+"\n            ")]),t.waybill.isEditable?e("section",{staticClass:"edit-wrapper"},[e("span",{directives:[{name:"show",rawName:"v-show",value:!t.editing.isEditing,expression:"!editing.isEditing"}],on:{click:t.editHandler}},[t._v("редактировать")]),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.editing.isEditing,expression:"!editing.isEditing"}],staticClass:"remove",on:{click:t.deleteWaybill}},[t._v("удалить")]),e("img",{directives:[{name:"show",rawName:"v-show",value:t.editing.isEditing,expression:"editing.isEditing"}],staticClass:"icon",attrs:{src:"/svgs/check.svg",alt:"сохранить изменения"},on:{click:t.initUpdateWaybill}}),e("img",{directives:[{name:"show",rawName:"v-show",value:t.editing.isEditing,expression:"editing.isEditing"}],staticClass:"icon",attrs:{src:"/svgs/times.svg",alt:"отменить изменения"},on:{click:t.editHandler}})]):t._e(),t.waybill.deliveryDate?e("p",{staticClass:"delivery-date"},[t._v(t._s(t.waybill.deliveryDate))]):e("p",{staticClass:"delivery-date"},[t._v("Резерв")])]),e("div",{staticClass:"content"},[e("ProductsTable",{attrs:{data:t.waybill.products,"has-numbering":!0,"is-editable":t.editing.isEditing},on:{quantityChange:t.onQuantityChange,remove:t.onRemove}}),t.editing.isEditing?e("MDRaisedButton",{attrs:{text:"Добавить Товар"},on:{click:t.onAddButtonClick}}):t._e(),t.editing.isEditing?e("MDInput",{ref:"comment",staticClass:"comment-min",attrs:{label:"Комментарий"}}):t._e(),!t.editing.isEditing&&t.waybill.comment?e("p",{staticClass:"comment"},[t._v("Примечание: "+t._s(t.waybill.comment))]):t._e(),t.editing.isEditing||t.waybill.comment?t._e():e("p",{staticClass:"comment"},[t._v("Нету примечания")]),e("div",{staticClass:"sub-items"},[t.waybill.isPaid?e("p",{staticClass:"is-paid is-paid-true"},[t._v("Оплачен")]):t._e(),t.waybill.isPaid?t._e():e("p",{staticClass:"is-paid is-paid-false"},[t._v("Не оплачен")]),e("p",{staticClass:"total-price"},[t._v("Всего:\n                    "),t.editing.isEditing?t._e():e("span",{staticClass:"bold"},[t._v(t._s(t.waybill.totalPrice)+"₴")]),t.editing.isEditing?e("span",{staticClass:"bold"},[t._v(t._s(t.calculatedTotalPrice)+"₴")]):t._e()])])],1)]):t._e(),e("section",{staticClass:"center"},[t.isLoading?e("LoadingSpinner"):t._e()],1),t.hasWaybill||t.isLoading?t._e():e("p",{staticClass:"error"},[t._v("Накладная с номером: "+t._s(t.id)+". Не найдена")]),t.editing.isEditing?e("WaybillEditingDialog",{ref:"dialogWrapper",attrs:{"products-data":t.waybill.products}}):t._e()],1)},n=[],s=(e("ac6a"),e("f499")),l=e.n(s),r=e("5176"),c=e.n(r),o=e("cebc"),u=e("2f62"),d=e("e5e2"),p=e("4ccc"),b=e("be12"),f=e("d777"),h=e("7032"),g=e("7b58"),m=e("e072"),y=e("0043"),v={name:"Waybill",components:{MDRaisedButton:h["a"],MDInput:g["a"],LoadingSpinner:m["a"],ProductsTable:f["a"],WaybillEditingDialog:function(){return Promise.all([e.e("chunk-1c459014"),e.e("chunk-05306aa4")]).then(e.bind(null,"8800"))}},data:function(){return{waybill:null,waybillCopy:null,editing:{isEditing:!1}}},methods:Object(o["a"])({},Object(u["b"])(d["a"].waybills,[p["a"].waybills.GET_EXTENDED_WAYBILL]),Object(u["d"])(d["a"].waybills,[b["a"].waybills.REMOVE_WAYBILL,b["a"].waybills.UPDATE_WAYBILL]),{loadWaybill:function(){var t=this;this.getExtendedWaybill(this.id).then(function(i){t.waybill=i})},deleteWaybill:function(){var t=this;y["a"].deleteWaybill(this.id).then(function(){t.removeWaybill(t.id),t.$router.push({name:"waybills"})}).catch(function(t){console.error({e:t}),alert("Произошла ошибка")})},cancelAllChanges:function(){this.waybill=c()({},this.waybillCopy),this.waybillCopy=null},editHandler:function(){var t=this;this.editing.isEditing=!this.editing.isEditing,!1===this.editing.isEditing?this.cancelAllChanges():(this.waybillCopy=JSON.parse(l()(this.waybill)),this.waybill.products.forEach(function(t){t.isValid=!0}),setTimeout(function(){t.$refs.comment.data=t.waybill.comment},100))},initUpdateWaybill:function(){var t=this.$refs.comment.data,i=[];this.waybill.products.forEach(function(t){i.push({id:t.id,boughtQuantity:t.boughtQuantity})}),this.waybillCopy=null,this.waybill.totalPrice=this.calculatedTotalPrice,this.waybill.comment=t,this.editing.isEditing=!1,console.log({waybill:this.waybill}),this.updateWaybill(this.waybill)},onAddButtonClick:function(){var t=this;this.$refs.dialogWrapper.$refs.dialog.show(),setTimeout(function(){t.$refs.dialogWrapper.$refs.searchInput.focus()},500)},onRemove:function(t){this.waybill.products[t]&&this.waybill.products.splice(t,1)},onQuantityChange:function(t){var i=t.item,e=t.newQuantity;i.boughtQuantity=e}}),computed:Object(o["a"])({},Object(u["c"])(d["a"].waybills,["isLoading"]),Object(u["c"])(d["a"].user,["pricesType"]),{calculatedTotalPrice:function(){var t=this,i=0;return this.waybill.products.forEach(function(e){var a;a=t.pricesType in e?e[t.pricesType]:e.price,i+=e.boughtQuantity*a}),Math.round(1e3*i)/1e3},id:function(){return this.$route&&this.$route.params?this.$route.params.id:null},hasId:function(){return null!==this.id},hasWaybill:function(){return null!==this.waybill}}),mounted:function(){this.hasId&&this.loadWaybill()}},_=v,w=(e("7459"),e("2877")),E=Object(w["a"])(_,a,n,!1,null,"8b95d1f0",null);i["default"]=E.exports},d777:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("section",[e("div",{staticClass:"table",class:{"editable-numbering":t.isEditable&&t.hasNumbering,editable:t.isEditable&&!t.hasNumbering,default:!t.isEditable&&!t.hasNumbering}},[e("div",{staticClass:"head",style:{"margin-right":t.isBodyOverflowed?"15px":""}},[(t.isFullSize,e("div",{staticClass:"row"},[t.hasNumbering?e("p",{staticClass:"numbering-column"},[t._v("#")]):t._e(),e("p",{staticClass:"name-column"},[t._v("Название")]),e("p",{staticClass:"quantity-column"},[t._v("Кол.")]),e("p",{staticClass:"price-column"},[t._v("Цена")]),t.isEditable?e("p",{staticClass:"trash-column"}):t._e()]))]),e("div",{ref:"body",staticClass:"body",style:{height:-1===t.height?"":t.height-35+"px"}},t._l(t.data,function(i,a){return e("div",{key:i.id,staticClass:"row"},[t.hasNumbering?e("p",{staticClass:"numbering-column"},[t._v(t._s(a+1))]):t._e(),e("p",{staticClass:"name-column",class:{clickable:i.hasImage},on:{click:function(e){return t.imagePreview(i)}}},[t._v(t._s(i.name))]),e("div",{staticClass:"quantity-column"},[t.isEditable?e("input",{attrs:{type:"number",min:"1",max:i.quantity},domProps:{value:i.boughtQuantity},on:{input:function(e){return t.quantityPickerInputHandler(e,i)}}}):e("span",[t._v(t._s(i.boughtQuantity))])]),e("p",{staticClass:"price-column"},[t._v("\n                    "+t._s(t.parsePrice(i))+"₴\n                ")]),t.isEditable?e("div",{staticClass:"trash-column"},[e("img",{staticClass:"trash clickable",attrs:{src:"/svgs/trash.svg"},on:{click:function(i){return t.remove(a)}}})]):t._e()])}),0)]),t.isFullSize?e("div",{staticClass:"bottom"}):t._e()])},n=[],s=e("cebc"),l=e("e814"),r=e.n(l),c=(e("c5f6"),e("06b1")),o=e("f8b7"),u=e("2f62"),d=e("e5e2"),p={name:"ProductsTable",props:{data:{type:Array,required:!0},height:{type:Number,default:-1},isFullSize:{type:Boolean,default:!0},isEditable:{type:Boolean,default:!0},hasNumbering:{type:Boolean,default:!1}},data:function(){return{isBodyOverflowed:!1,animationFrame:null,eventBus:null}},methods:{remove:function(t){this.$emit("remove",t)},quantityPickerInputHandler:function(t,i){event.target.value<0&&(event.target.value=0),this.$emit("quantityChange",{item:i,newQuantity:r()(event.target.value)})},imagePreview:function(t){t.hasImage&&this.eventBus&&this.eventBus.$emit(o["b"].showImagePreview,c["a"].fullSizeImageURL(t.id))},parsePrice:function(t){return this.pricesType in t?t[this.pricesType]:t.price}},computed:Object(s["a"])({},Object(u["c"])(d["a"].user,["pricesType"])),mounted:function(){var t=this;if(this.eventBus=o["a"],-1!==this.height){var i=function i(){t.animationFrame&&cancelAnimationFrame(t.animationFrame),t.$refs.body&&(t.isBodyOverflowed=t.$refs.body.scrollHeight>t.$refs.body.clientHeight),t.animationFrame=requestAnimationFrame(i)};i()}},updated:function(){this.eventBus=o["a"]}},b=p,f=(e("7afe"),e("2877")),h=Object(f["a"])(b,a,n,!1,null,"b0fc5192",null);i["a"]=h.exports},e692:function(t,i){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(t,i,e){t.exports=e("b9e9")},eb59:function(t,i,e){},fdef:function(t,i){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=waybill.56be3931.js.map