(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["waybill"],{"0f2f":function(t,e,i){"use strict";var n=i("678a"),a=i.n(n);a.a},"4ccc":function(t,e,i){"use strict";var n=i("0683"),a=i("c2e0"),s="login",r="logout",o={LOGIN:s,LOGOUT:r};e["a"]={catalog:n["g"],waybills:a["d"],user:o}},5176:function(t,e,i){t.exports=i("51b6")},"51b6":function(t,e,i){i("a3c3"),t.exports=i("584a").Object.assign},"5d6b":function(t,e,i){var n=i("e53d").parseInt,a=i("a1ce").trim,s=i("e692"),r=/^[-+]?0[xX]/;t.exports=8!==n(s+"08")||22!==n(s+"0x16")?function(t,e){var i=a(String(t),3);return n(i,e>>>0||(r.test(i)?16:10))}:n},"5dbc":function(t,e,i){var n=i("d3f4"),a=i("8b97").set;t.exports=function(t,e,i){var s,r=e.constructor;return r!==i&&"function"==typeof r&&(s=r.prototype)!==i.prototype&&n(s)&&a&&a(t,s),t}},"678a":function(t,e,i){},7445:function(t,e,i){var n=i("63b6"),a=i("5d6b");n(n.G+n.F*(parseInt!=a),{parseInt:a})},7966:function(t,e,i){"use strict";var n=i("f483"),a=i.n(n);a.a},"8b97":function(t,e,i){var n=i("d3f4"),a=i("cb7c"),s=function(t,e){if(a(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,i){return s(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:s}},9306:function(t,e,i){"use strict";var n=i("c3a1"),a=i("9aa9"),s=i("355d"),r=i("241e"),o=i("335c"),c=Object.assign;t.exports=!c||i("294c")(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=c({},t)[i]||Object.keys(c({},e)).join("")!=n})?function(t,e){var i=r(t),c=arguments.length,l=1,u=a.f,d=s.f;while(c>l){var g,h=o(arguments[l++]),p=u?n(h).concat(u(h)):n(h),f=p.length,b=0;while(f>b)d.call(h,g=p[b++])&&(i[g]=h[g])}return i}:c},a1ce:function(t,e,i){var n=i("63b6"),a=i("25eb"),s=i("294c"),r=i("e692"),o="["+r+"]",c="​",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),d=function(t,e,i){var a={},o=s(function(){return!!r[t]()||c[t]()!=c}),l=a[t]=o?e(g):r[t];i&&(a[i]=l),n(n.P+n.F*o,"String",a)},g=d.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},a3c3:function(t,e,i){var n=i("63b6");n(n.S+n.F,"Object",{assign:i("9306")})},aa77:function(t,e,i){var n=i("5ca1"),a=i("be13"),s=i("79e5"),r=i("fdef"),o="["+r+"]",c="​",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),d=function(t,e,i){var a={},o=s(function(){return!!r[t]()||c[t]()!=c}),l=a[t]=o?e(g):r[t];i&&(a[i]=l),n(n.P+n.F*o,"String",a)},g=d.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},b9e9:function(t,e,i){i("7445"),t.exports=i("584a").parseInt},c5f6:function(t,e,i){"use strict";var n=i("7726"),a=i("69a8"),s=i("2d95"),r=i("5dbc"),o=i("6a99"),c=i("79e5"),l=i("9093").f,u=i("11e9").f,d=i("86cc").f,g=i("aa77").trim,h="Number",p=n[h],f=p,b=p.prototype,y=s(i("2aeb")(b))==h,v="trim"in String.prototype,m=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=v?e.trim():g(e,3);var i,n,a,s=e.charCodeAt(0);if(43===s||45===s){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:n=2,a=49;break;case 79:case 111:n=8,a=55;break;default:return+e}for(var r,c=e.slice(2),l=0,u=c.length;l<u;l++)if(r=c.charCodeAt(l),r<48||r>a)return NaN;return parseInt(c,n)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof p&&(y?c(function(){b.valueOf.call(i)}):s(i)!=h)?r(new f(m(e)),i,p):m(e)};for(var _,C=i("9e1e")?l(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;C.length>w;w++)a(f,_=C[w])&&!a(p,_)&&d(p,_,u(f,_));p.prototype=b,b.constructor=p,i("2aba")(n,h,p)}},cb72:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",[t.hasWaybill?i("section",{staticClass:"layout-waybill"},[i("div",{staticClass:"header"},[i("p",{staticClass:"title"},[t._v("\n                #"+t._s(t.waybill.numberInvoice)+"\n            ")]),t.waybill.isEditable?i("section",{staticClass:"edit-wrapper"},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.editing.isEditing,expression:"!editing.isEditing"}],on:{click:t.editHandler}},[t._v("редактировать")]),i("img",{directives:[{name:"show",rawName:"v-show",value:t.editing.isEditing,expression:"editing.isEditing"}],staticClass:"icon",attrs:{src:"/svgs/check.svg",alt:"сохранить изменения"}}),i("img",{directives:[{name:"show",rawName:"v-show",value:t.editing.isEditing,expression:"editing.isEditing"}],staticClass:"icon",attrs:{src:"/svgs/times.svg",alt:"отменить изменения"},on:{click:t.editHandler}})]):t._e(),t.waybill.deliveryDate?i("p",{staticClass:"delivery-date"},[t._v(t._s(t.waybill.deliveryDate))]):i("p",{staticClass:"delivery-date"},[t._v("Резерв")])]),i("div",{staticClass:"content"},[i("ProductsTable",{attrs:{data:t.waybill.products,"has-numbering":!0,"is-editable":t.editing.isEditing},on:{quantityChange:t.onQuantityChange,remove:t.onRemove}}),t.editing.isEditing?i("MDRaisedButton",{attrs:{text:"Добавить Товар"},on:{click:t.onAddButtonClick}}):t._e(),t.editing.isEditing?i("MDInput",{staticClass:"comment-min",attrs:{label:"Комментарий"}}):t._e(),!t.editing.isEditing&&t.waybill.comment?i("p",{staticClass:"comment"},[t._v("Примечание: "+t._s(t.waybill.comment))]):t._e(),t.editing.isEditing||t.waybill.comment?t._e():i("p",{staticClass:"comment"},[t._v("Нету примечания")]),i("div",{staticClass:"sub-items"},[t.waybill.isPaid?i("p",{staticClass:"is-paid is-paid-true"},[t._v("Оплачен")]):t._e(),t.waybill.isPaid?t._e():i("p",{staticClass:"is-paid is-paid-false"},[t._v("Не оплачен")]),i("p",{staticClass:"total-price"},[t._v("Всего:\n                    "),t.editing.isEditing?t._e():i("span",{staticClass:"bold"},[t._v(t._s(t.waybill.totalPrice)+"₴")]),t.editing.isEditing?i("span",{staticClass:"bold"},[t._v(t._s(t.calculatedTotalPrice)+"₴")]):t._e()])])],1)]):t._e(),i("section",{staticClass:"center"},[t.isLoading?i("LoadingSpinner"):t._e()],1),t.hasWaybill||t.isLoading?t._e():i("p",{staticClass:"error"},[t._v("Накладная с номером: "+t._s(t.id)+". Не найдена")]),t.editing.isEditing?i("Dialog",{ref:"dialog",attrs:{"can-return":0!==t.editing.category.length||0!==t.editing.searchRequest.length},on:{hide:t.onDialogHide,return:t.onDialogReturn}},[""===t.editing.category&&""===t.editing.searchRequest?i("section",[i("section",{staticClass:"search-wrapper"},[i("div",{staticClass:"search"},[i("input",{ref:"searchInput",attrs:{placeholder:"Поиск Товара",type:"text",autocorrect:"off",autocapitalize:"off"},on:{input:t.onSearchInput,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearchResultChoose(e.target.value)}}}),0!==t.editing.searchHelperResults.length&&""===t.editing.category?i("section",{staticClass:"search-helper"},t._l(t.editing.searchHelperResults,function(e){return i("p",{on:{click:function(i){return t.onSearchResultChoose(e)}}},[t._v(t._s(e))])}),0):t._e()])]),i("CategoryChoose",{attrs:{"is-component":!0,data:t.waybill.products},on:{choose:t.onCategoryChoose,basketRemove:t.onRemove}})],1):t._e(),""!==t.editing.category||""!==t.editing.parentCategory||""!==t.editing.searchRequest?i("Catalog",{attrs:{"is-component":!0,category:t.editing.category,"parent-category":t.editing.parentCategory,"search-request-prop":t.editing.searchRequest,data:t.waybill.products,"button-text":"Добавить"},on:{buy:t.onBuy,basketRemove:t.onRemove}}):t._e()],1):t._e()],1)},a=[],s=(i("7514"),i("ac6a"),i("f499")),r=i.n(s),o=i("5176"),c=i.n(o),l=i("cebc"),u=i("2f62"),d=i("e5e2"),g=i("4ccc"),h=i("d777"),p=i("7032"),f=i("7b58"),b=i("e072"),y=i("d175"),v={name:"Waybill",components:{MDRaisedButton:p["a"],MDInput:f["a"],LoadingSpinner:b["a"],ProductsTable:h["a"],CategoryChoose:function(){return i.e("chunk-0c14d0da").then(i.bind(null,"ac0c"))},Dialog:function(){return Promise.resolve().then(i.bind(null,"2017"))},Catalog:function(){return i.e("chunk-78e24714").then(i.bind(null,"247d"))}},data:function(){return{waybill:null,waybillCopy:null,editing:{isEditing:!1,searchHelperResults:[],category:"",parentCategory:"",searchRequest:""}}},methods:Object(l["a"])({},Object(u["b"])(d["a"].waybills,[g["a"].waybills.GET_EXTENDED_WAYBILL]),{loadWaybill:function(){var t=this;this.getExtendedWaybill(this.id).then(function(e){t.waybill=e})},cancelAllChanges:function(){this.waybill=c()({},this.waybillCopy),this.waybillCopy=null},editHandler:function(){this.editing.isEditing=!this.editing.isEditing,!1===this.editing.isEditing?this.cancelAllChanges():(this.waybillCopy=JSON.parse(r()(this.waybill)),this.waybill.products.forEach(function(t){t.isValid=!0}))},onBuy:function(t){var e=this.waybill.products.find(function(e){return e.id===t.id});if(e)e.boughtQuantity++;else{var i=JSON.parse(r()(t));i.boughtQuantity=1,i.isValid=!0,this.waybill.products.push(i)}},onSearchInput:function(t){var e=this,i=t.target.value;0!==i.length?y["a"].getSearchHelper(i).then(function(t){null!==t?t.json().then(function(t){e.editing.searchHelperResults=t}):e.editing.searchHelperResults=[]}):0!==this.editing.searchHelperResults.length&&(this.editing.searchHelperResults=[])},onSearchResultChoose:function(t){this.editing.searchRequest=t,this.editing.searchHelperResults=[]},onCategoryChoose:function(t){this.editing.category=t.category,this.editing.parentCategory=t.parentCategory,this.editing.searchHelperResults=[]},onAddButtonClick:function(){var t=this;this.$refs.dialog.show(),setTimeout(function(){t.$refs.searchInput.focus()},500)},onDialogReturn:function(){this.editing.category="",this.editing.parentCategory="",this.editing.searchRequest=""},onDialogHide:function(){this.editing.category=""},onRemove:function(t){1!==this.waybill.products.length&&this.waybill.products.splice(t,1)},onQuantityChange:function(t){var e=t.item,i=t.newQuantity;e.boughtQuantity=i}}),computed:Object(l["a"])({},Object(u["c"])(d["a"].waybills,["isLoading"]),{calculatedTotalPrice:function(){var t=0;return this.waybill.products.forEach(function(e){t+=e.boughtQuantity*e.price}),Math.round(1e3*t)/1e3},id:function(){return this.$route&&this.$route.params?this.$route.params.id:null},hasId:function(){return null!==this.id},hasWaybill:function(){return null!==this.waybill}}),mounted:function(){this.hasId&&this.loadWaybill()}},m=v,_=(i("7966"),i("2877")),C=Object(_["a"])(m,n,a,!1,null,"25a63fc1",null);e["default"]=C.exports},d777:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",[i("div",{staticClass:"table",class:{"editable-numbering":t.isEditable&&t.hasNumbering,editable:t.isEditable&&!t.hasNumbering}},[i("div",{staticClass:"head",style:{"margin-right":t.isBodyOverflowed?"15px":""}},[(t.isFullSize,i("div",{staticClass:"row"},[t.hasNumbering?i("p",{staticClass:"numbering-column"},[t._v("#")]):t._e(),i("p",{staticClass:"name-column"},[t._v("Название")]),i("p",{staticClass:"quantity-column"},[t._v("Кол.")]),i("p",{staticClass:"price-column"},[t._v("Цена")]),t.isEditable?i("p",{staticClass:"trash-column"}):t._e()]))]),i("div",{ref:"body",staticClass:"body",style:{height:-1===t.height?"":t.height-35+"px"}},t._l(t.data,function(e,n){return i("div",{key:e.id,staticClass:"row"},[t.hasNumbering?i("p",{staticClass:"numbering-column"},[t._v(t._s(n+1))]):t._e(),i("p",{staticClass:"name-column",class:{clickable:e.hasImage},on:{click:function(i){return t.imagePreview(e)}}},[t._v(t._s(e.name))]),i("div",{staticClass:"quantity-column"},[t.isEditable?i("input",{attrs:{type:"number",min:"1",max:e.quantity},domProps:{value:e.boughtQuantity},on:{input:function(i){return t.quantityPickerInputHandler(i,e)}}}):i("span",[t._v(t._s(e.boughtQuantity))])]),i("p",{staticClass:"price-column"},[t._v("\n                    "+t._s(e.price)+"₴\n                ")]),t.isEditable?i("div",{staticClass:"trash-column"},[i("img",{staticClass:"trash clickable",attrs:{src:"/svgs/trash.svg"},on:{click:function(e){return t.remove(n)}}})]):t._e()])}),0)]),t.isFullSize?i("div",{staticClass:"bottom"}):t._e()])},a=[],s=i("e814"),r=i.n(s),o=(i("c5f6"),i("06b1")),c=i("f8b7"),l={name:"ProductsTable",props:{data:{type:Array,required:!0},height:{type:Number,default:-1},isFullSize:{type:Boolean,default:!0},isEditable:{type:Boolean,default:!0},hasNumbering:{type:Boolean,default:!1}},data:function(){return{isBodyOverflowed:!1,animationFrame:null}},methods:{remove:function(t){this.$emit("remove",t)},quantityPickerInputHandler:function(t,e){event.target.value<0&&(event.target.value=0),this.$emit("quantityChange",{item:e,newQuantity:r()(event.target.value)})},imagePreview:function(t){t.hasImage&&c["a"].$emit(c["b"].showImagePreview,o["a"].fullSizeImageURL(t.id))}},mounted:function(){var t=this;if(-1!==this.height){var e=function e(){t.animationFrame&&cancelAnimationFrame(t.animationFrame),t.$refs.body&&(t.isBodyOverflowed=t.$refs.body.scrollHeight>t.$refs.body.clientHeight),t.animationFrame=requestAnimationFrame(e)};e()}}},u=l,d=(i("0f2f"),i("2877")),g=Object(d["a"])(u,n,a,!1,null,"f4966c7a",null);e["a"]=g.exports},e692:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(t,e,i){t.exports=i("b9e9")},f483:function(t,e,i){},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=waybill.10e272c3.js.map